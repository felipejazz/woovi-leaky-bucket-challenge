FROM node:18
ARG MONGO_URI
ARG SECRET_KEY
ARG REDIS_URL
ARG REDIS_HOST
ARG REDIS_PORT
ARG WEBSITE_URL

ENV MONGO_URI=$MONGO_URI
ENV SECRET_KEY=$SECRET_KEY
ENV REDIS_URL=$REDIS_URL
ENV REDIS_HOST=$REDIS_HOST
ENV REDIS_PORT=$REDIS_PORT
ENV WEBSITE_URL=$WEBSITE_URL

WORKDIR /usr/src/app

COPY package*.json ./

RUN npm install

COPY . .

RUN npm run build

EXPOSE 3000

CMD [ "npm", "run", "start" ]

